<section class="py-20 mb-20 text-gray-700 border bg-gray-50">
  <div class="container mx-auto">
    <div class="p-4 bg-white border rounded-lg shadow-md sm:p-6">
      <div class="grid grid-cols-12">
        <div class="col-span-3 border-r">
          <div class="flex flex-col justify-center">
            <span class="relative flex w-20 h-20 m-auto rounded-full bg-primary-300 lg:w-40 lg:h-40">
              <% if @user.avatar.present? %>
                <%= image_tag @user.avatar, class: "object-cover w-20 h-20 rounded-full lg:w-40 lg:h-40" %>
              <% end %>
              <% if @user == current_user %>
                <%= link_to edit_user_registration_path do %>
                  <span class="absolute top-0 right-0 -mr-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                    </svg>
                  </span>
                <% end %>
              <% end %>
            </span>
            <div class="text-center">
              <h3 class="m-auto mt-2 text-xl font-medium">
                <%= full_name(@user) %>
              </h3>
              <p class="mx-auto font-normal text-gray-500">
                <%= @user.organization %>
              </p>
              <p class="mx-auto overflow-hidden italic font-normal text-gray-500 text-ellipsis max-w-1/2 hover:overflow-visible">
                <a href="<%= "mailto:#{@user.email}" %>">
                  <%= @user.email %>
                </a>
              </p>
            </div>
          </div>
        </div>
        <div class="col-span-6">
          <% if policy(@user).update_settings? %>
            <details class="transition ease-in-out delay-150 group" open>
              <summary class="flex justify-between">
                <div class="flex mx-2">
                  <svg class="w-5 h-5 my-auto group-open:rotate-180" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                  <h4 class="font-semibold text-l">Settings</h4>
                </div>

              </summary>
              <div class="mt-4 ml-4 mr-10">
                <%= render "settings_form"%>
              </div>
            </details>
          <% end %>
        </div>

        <div class="col-span-3 border-l">
          <% if @user == current_user %>
            <div class="mx-4">
              <h4 class="mb-4 font-semibold text-l">Administration</h4>
              <% if policy([:admin, :user]).index? %>
                <%= link_to "/admin/users" do %>
                  <div class="flex my-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="hidden w-6 h-6 mr-2 lg:block" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                    </svg>
                    <p class="">Users table</p>
                  </div>
                <% end %>
              <% end %>
              <% if policy(:category).index? %>
                <%= link_to categories_path do %>
                  <div class="flex my-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="hidden w-6 h-6 mr-2 lg:block" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                    </svg>
                    <p class="">Forum categories</p>
                  </div>
                <% end %>
              <% end %>
              <% if current_user.has_role?(:admin) %>
                <%= link_to "/admin/sidekiq" do %>
                  <div class="flex my-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="hidden w-6 h-6 mr-2 lg:block" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                    </svg>
                    <p class="">Sidekiq jobs</p>
                  </div>
                <% end %>
                <%= link_to rswag_ui_path do %>
                  <div class="flex my-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="hidden w-6 h-6 mr-2 lg:block" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    <p class="">API Docs</p>
                  </div>
                <% end %>
                <%= link_to oauth_applications_path do %>
                  <div class="flex my-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="hidden w-6 h-6 mr-2 lg:block" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                    </svg>
                    <p class="">Apps</p>
                  </div>
                <% end %>

              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <div class="container mx-auto">
    <div class="p-4 mt-8 bg-white border rounded-lg shadow-md sm:p-6 ">
      <details class="transition ease-in-out delay-150 group" open>
        <summary class="flex justify-between mb-2">
          <div class="flex mx-2">
            <svg class="w-5 h-5 my-auto group-open:rotate-180" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
            <h4 class="mt-0 font-semibold text-l">Recent activity</h4>
          </div>
        </summary>
        <div class="ml-4">
          <% if @activities.count > 0 %>
            <%= render "activities", activities: @activities %>
          <% else %>
            <%= render Forms::PHelperComponent.new().with_content("No activity yet. Events like uploads and forum activity will be displayed here.") %>
          <% end %>
        </div>
      </details>
    </div>
  </div>
</section>
